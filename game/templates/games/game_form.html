{% extends "base.html" %}
{% block title %}Add game{% endblock title %}

{% block content %}
<div class="p-8">
  {% csrf_token %}
    <!-- Main Content with Form -->
    <h1 class="text-2xl font-bold mb-4">Add Game</h1>
    <!-- Game Form -->
    <form id="gameForm" class="w-full max-w-md">
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="title">
          Title
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="title" type="text" placeholder="Title">
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="platform">
          Platform
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="platform" type="text" placeholder="Platform">
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="release_date">
          Release Date
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="release_date" type="date">
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="price">
          Price
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="price" type="number">
      </div>

      <div class="flex items-center justify-between">
        <button id="submitBtn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button">
            Add Game
        </button>
      </div>
    </form>
  </div>
  
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const form = document.getElementById("gameForm");
            const submitBtn = document.getElementById("submitBtn");
        
            submitBtn.addEventListener("click", function() {
                // Serialize form data
                const formData = new FormData(form);
        
                // Send form data to Django backend using fetch API
                fetch("{% url 'game_create' %}", {
                    method: "POST",
                    body: formData,
                    headers: {
                        "X-CSRFToken": "{{ csrf_token }}",
                    },
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
                })
                .then(data => {
                    // Handle success response
                    console.log(data);
                    // You can perform additional actions here, such as showing a success message or redirecting the user
                })
                .catch(error => {
                    // Handle error
                    console.error("There was a problem with your fetch operation:", error);
                    // You can show an error message to the user or perform other error handling actions
                });
            });
        });
    </script>

    
    <script>
      document.addEventListener("DOMContentLoaded", function() {
          const deleteButtons = document.querySelectorAll(".deleteBtn");
      
          deleteButtons.forEach(button => {
              button.addEventListener("click", function() {
                  const gameId = this.dataset.gameId;
                  if (confirm("Are you sure you want to delete this game?")) {
                      fetch(`/games/${gameId}/delete/`, {
                          method: "DELETE",
                          headers: {
                              "X-CSRFToken": "{{ csrf_token }}",
                          },
                      })
                      .then(response => {
                          if (!response.ok) {
                              throw new Error("Network response was not ok");
                          }
                          return response.json();
                      })
                      .then(data => {
                          // Handle success response
                          console.log(data);
                          // You can perform additional actions here, such as removing the deleted game from the UI
                      })
                      .catch(error => {
                          // Handle error
                          console.error("There was a problem with your fetch operation:", error);
                          // You can show an error message to the user or perform other error handling actions
                      });
                  }
              });
          });
      });
      </script>
      
    
{% endblock content %}